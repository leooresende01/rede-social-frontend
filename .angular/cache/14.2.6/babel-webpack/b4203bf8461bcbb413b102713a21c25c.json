{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Maria S\\xF4nia/Documents/Workspace-Node/rede-social/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { SeguidoresSeguindoUtil } from './../../../../core/util/seguidores-seguindo.util';\nimport { catchError } from 'rxjs';\nimport { ElementRef } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { urlApi } from 'src/core/util/url-api';\nimport { UsuarioUtil } from 'src/core/util/usuario.util';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/core/service/user-authenticate.service\";\nimport * as i3 from \"src/core/service/mensagem.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../shared/spinner-loading/spinner-loading.component\";\nimport * as i7 from \"./mensagens/mensagens.component\";\nconst _c0 = [\"chatArea\"];\n\nfunction ChatMensagemComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"rs-mensagens\", 17);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const mensagem_r2 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"usuarioAuthenticadoUsername\", ctx_r1.usuarioAuthenticadoUsername)(\"mensagem\", mensagem_r2);\n  }\n}\n\nconst _c1 = function () {\n  return [\"/home\", \"chats\"];\n};\n\nconst _c2 = function (a1) {\n  return [\"/home\", a1];\n};\n\nexport class ChatMensagemComponent {\n  constructor(activateRouter, userAuthService, mensagemService, formBuilder) {\n    this.activateRouter = activateRouter;\n    this.userAuthService = userAuthService;\n    this.mensagemService = mensagemService;\n    this.formBuilder = formBuilder;\n    this.urlApi = urlApi;\n  }\n\n  ngOnInit() {\n    this.usuarioAuthenticadoUsername = this.userAuthService.pegarUsernameUsuarioAutenticado();\n    this.paramsUrlSubscription = this.activateRouter.params.subscribe(params => this.buscarMensagensDoChat(params));\n    this.formGroup = this.formBuilder.group({\n      mensagem: ['', [Validators.required, Validators.maxLength(1000)]]\n    });\n    this.mensagemSubscription = this.mensagemService.escutarMensagensDoServidor().pipe(catchError( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (err) {\n        return alert(err);\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }())).subscribe(mensagem => this.mensagens.push(mensagem) && this.scrollToBottom(), err => alert('erro'), () => alert('Porra'));\n  }\n\n  buscarMensagensDoChat(params) {\n    const username = params['username'];\n    this.outroUsuarioDoChat = username;\n    this.mensagensChatSubscription = this.mensagemService.buscarMensagensComOUsuario(username).subscribe(mensagens => {\n      this.mensagens = mensagens;\n      this.scrollToBottom();\n    });\n  }\n\n  enviarMensagem() {\n    const mensagem = this.formGroup.get('mensagem')?.value;\n    const mensagemDto = this.mensagemService.enviarMensagem(mensagem, this.outroUsuarioDoChat);\n    this.mensagens.push(mensagemDto);\n    this.mensagens = this.mensagens;\n    this.formGroup.reset();\n    this.scrollToBottom();\n  }\n\n  scrollToBottom() {\n    try {\n      setTimeout(() => this.chatMensagensArea.nativeElement.scrollTop = this.chatMensagensArea.nativeElement.scrollHeight, 200);\n    } catch (err) {}\n  }\n\n  errorImage(event) {\n    UsuarioUtil.definirImagemDefault(event);\n  }\n\n  ngOnDestroy() {\n    SeguidoresSeguindoUtil.desativarObservable(this.mensagensChatSubscription, this.mensagemSubscription, this.paramsUrlSubscription);\n  }\n\n}\n\nChatMensagemComponent.ɵfac = function ChatMensagemComponent_Factory(t) {\n  return new (t || ChatMensagemComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.UserAuthenticateService), i0.ɵɵdirectiveInject(i3.MensagemService), i0.ɵɵdirectiveInject(i4.FormBuilder));\n};\n\nChatMensagemComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ChatMensagemComponent,\n  selectors: [[\"ng-component\"]],\n  viewQuery: function ChatMensagemComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.chatMensagensArea = _t.first);\n    }\n  },\n  decls: 22,\n  vars: 12,\n  consts: [[1, \"card-chat\"], [1, \"chat-com-usuarios\"], [1, \"card-topo\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"btn-close\", 3, \"routerLink\"], [1, \"d-flex\", \"align-items-center\", \"py-1\", \"info-usuario-chat\"], [1, \"position-relative\"], [\"alt\", \"Sharon Lessman\", \"width\", \"40\", \"height\", \"40\", 1, \"rounded-circle\", \"mr-1\", 3, \"src\", \"error\"], [1, \"flex-grow-1\", \"pl-3\", \"text-start\"], [1, \"btn\", \"btn-light\", \"border\", \"btn-lg\", \"px-3\", 3, \"routerLink\"], [1, \"chats\"], [\"chatArea\", \"\"], [3, \"elementoAguardado\"], [4, \"ngFor\", \"ngForOf\"], [1, \"flex-grow-0\", \"border-top\", \"enviar-mensagens\"], [1, \"input-group\", 3, \"formGroup\", \"submit\"], [\"formControlName\", \"mensagem\", \"type\", \"text\", \"placeholder\", \"Digite uma mensagem\", 1, \"form-control\", \"texto-input\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [3, \"usuarioAuthenticadoUsername\", \"mensagem\"]],\n  template: function ChatMensagemComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2);\n      i0.ɵɵelement(3, \"button\", 3);\n      i0.ɵɵelementStart(4, \"div\", 4)(5, \"div\", 5)(6, \"img\", 6);\n      i0.ɵɵlistener(\"error\", function ChatMensagemComponent_Template_img_error_6_listener($event) {\n        return ctx.errorImage($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(7, \"div\", 7)(8, \"strong\");\n      i0.ɵɵtext(9);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(10, \"div\")(11, \"button\", 8);\n      i0.ɵɵtext(12, \"Ver perfil\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(13, \"div\", 9, 10);\n      i0.ɵɵelement(15, \"rs-spinnerloading\", 11);\n      i0.ɵɵtemplate(16, ChatMensagemComponent_div_16_Template, 2, 2, \"div\", 12);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"div\", 13)(18, \"form\", 14);\n      i0.ɵɵlistener(\"submit\", function ChatMensagemComponent_Template_form_submit_18_listener() {\n        return ctx.enviarMensagem();\n      });\n      i0.ɵɵelement(19, \"input\", 15);\n      i0.ɵɵelementStart(20, \"button\", 16);\n      i0.ɵɵtext(21, \"Enviar\");\n      i0.ɵɵelementEnd()()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(9, _c1));\n      i0.ɵɵadvance(3);\n      i0.ɵɵpropertyInterpolate2(\"src\", \"\", ctx.urlApi, \"/api/v1/usuarios/\", ctx.outroUsuarioDoChat, \"}/imagemDoPerfil\", i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate(ctx.outroUsuarioDoChat);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(10, _c2, ctx.outroUsuarioDoChat));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"elementoAguardado\", ctx.mensagens);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.mensagens);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formGroup\", ctx.formGroup);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", ctx.formGroup.invalid);\n    }\n  },\n  dependencies: [i5.NgForOf, i1.RouterLink, i6.SpinnerLoadingComponent, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName, i7.MensagensComponent],\n  styles: [\".card-chat[_ngcontent-%COMP%] {\\r\\n\\tpadding: 30px 30vw;\\r\\n}\\r\\n\\r\\n.card-topo[_ngcontent-%COMP%] {\\r\\n\\tpadding: 10px;\\r\\n\\tdisplay: flex;\\r\\n\\talign-items: center;\\r\\n\\tborder-bottom: 1px solid var(--cor-de-fundo);\\r\\n}\\r\\n\\r\\n.card-topo[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%] {\\r\\n\\tfont-size: 25px;\\r\\n}\\r\\n\\r\\n.chat-com-usuarios[_ngcontent-%COMP%] {\\r\\n\\tbackground-color: white;\\r\\n\\tborder: 1px solid var(--cor-de-fundo);\\r\\n\\tborder-radius: 5px;\\r\\n\\twidth: 100%;\\r\\n}\\r\\n\\r\\n.info-usuario-chat[_ngcontent-%COMP%] {\\r\\n\\tcolumn-gap: 10px;\\r\\n\\tpadding: 0 5px 0 20px;\\r\\n\\tflex-grow: 1;\\r\\n}\\r\\n\\r\\n.espaco-msg[_ngcontent-%COMP%] {\\r\\n\\tpadding: 10px;\\r\\n}\\r\\n\\r\\n.espaco-msg-foto[_ngcontent-%COMP%] {\\r\\n\\tcolumn-gap: 5px;\\r\\n}\\r\\n\\r\\n.img-perfil[_ngcontent-%COMP%] {\\r\\n\\twidth: 45px;\\r\\n\\theight: 45px;\\r\\n\\tborder-radius: 35px;\\r\\n}\\r\\n\\r\\n.header-modal-align[_ngcontent-%COMP%] {\\r\\n\\tdisplay: grid;\\r\\n\\tgrid-template-columns: 1fr 1fr 1fr;\\r\\n}\\r\\n\\r\\n.chats[_ngcontent-%COMP%] {\\r\\n\\tpadding: 10px 15px;\\r\\n\\toverflow: auto;\\r\\n\\theight: 50vh;\\r\\n}\\r\\n\\r\\n.card[_ngcontent-%COMP%] {\\r\\n\\tborder: none;\\r\\n\\tborder-radius: 15px;\\r\\n}\\r\\n\\r\\n.form-control[_ngcontent-%COMP%] {\\r\\n\\tborder-radius: 12px;\\r\\n\\tborder: 1px solid #F0F0F0;\\r\\n\\tfont-size: 8px;\\r\\n}\\r\\n\\r\\n.form-control[_ngcontent-%COMP%]:focus {\\r\\n\\tbox-shadow: none;\\r\\n}\\r\\n\\r\\n.form-control[_ngcontent-%COMP%]::placeholder {\\r\\n\\tfont-size: 8px;\\r\\n\\tcolor: #C4C4C4;\\r\\n}\\r\\n\\r\\n.formulario-comentario[_ngcontent-%COMP%] {\\r\\n\\tmargin-top: 15px;\\r\\n\\tborder-top: 1px solid rgb(0 0 0 / 13%);\\r\\n}\\r\\n\\r\\n.formulario-comentario[_ngcontent-%COMP%] {\\r\\n\\tdisplay: flex;\\r\\n}\\r\\n\\r\\n.form-control[_ngcontent-%COMP%] {\\r\\n\\tpadding-top: 15px;\\r\\n\\tpadding-bottom: 15px;\\r\\n\\tborder-left: none;\\r\\n\\tborder-bottom: none;\\r\\n}\\r\\n\\r\\n.texto-input[_ngcontent-%COMP%] {\\r\\n\\tfont-size: 16px;\\r\\n}\\r\\n\\r\\n.texto-input[_ngcontent-%COMP%]::placeholder {\\r\\n\\tfont-size: 16px;\\r\\n}\\r\\n\\r\\n@media screen and (max-width: 1024px) {\\r\\n\\t.card-chat[_ngcontent-%COMP%] {\\r\\n\\t\\tpadding: 30px 15vw;\\r\\n\\t}\\r\\n}\\r\\n\\r\\n@media screen and (max-width: 768px) {\\r\\n\\t.card-chat[_ngcontent-%COMP%] {\\r\\n\\t\\tpadding: 0;\\r\\n\\t}\\r\\n\\r\\n\\t.chats[_ngcontent-%COMP%] {\\r\\n\\t\\toverflow: auto;\\r\\n\\t\\theight: calc(100vh - 200px);\\r\\n\\t\\tmax-height: none;\\r\\n\\t\\tmin-height: none;\\r\\n\\t\\tpadding: 20px 15px 50px 15px;\\r\\n\\t}\\r\\n\\r\\n\\t.chat-com-usuarios[_ngcontent-%COMP%] {\\r\\n\\t\\tbackground-color: white;\\r\\n\\t\\tborder: none;\\r\\n\\t\\tborder-radius: 0;\\r\\n\\t\\twidth: 100%;\\r\\n\\t}\\r\\n\\r\\n\\t.chat-username-usuario[_ngcontent-%COMP%] {\\r\\n\\t\\tfont-size: 15px;\\r\\n\\t}\\r\\n\\r\\n\\t.chat-ultima-mensagem[_ngcontent-%COMP%] {\\r\\n\\t\\tfont-size: 11px;\\r\\n\\t}\\r\\n\\r\\n\\t.horario-envio-mensagem[_ngcontent-%COMP%] {\\r\\n\\t\\tfont-size: 9px;\\r\\n\\t}\\r\\n\\r\\n\\t.enviar-mensagens[_ngcontent-%COMP%] {\\r\\n\\t\\tposition: absolute;\\r\\n\\t\\tbackground-color: white;\\r\\n\\t\\tbottom: 0;\\r\\n\\t\\tright: 0;\\r\\n\\t\\tleft: 0;\\r\\n\\t}\\r\\n}\\r\\n\\r\\n@media screen and (max-width: 350px) {\\r\\n\\t.card-topo[_ngcontent-%COMP%] {\\r\\n\\t\\tpadding: 20px 0;\\r\\n\\t\\ttext-align: center;\\r\\n\\t\\tborder-bottom: 1px solid var(--cor-de-fundo);\\r\\n\\t}\\r\\n\\r\\n\\t.menor[_ngcontent-%COMP%] {\\r\\n\\t\\tfont-size: 11px;\\r\\n\\t}\\r\\n\\r\\n\\t.chat-username-usuario[_ngcontent-%COMP%] {\\r\\n\\t\\tfont-size: 11px;\\r\\n\\t}\\r\\n\\r\\n\\t.chat-ultima-mensagem[_ngcontent-%COMP%] {\\r\\n\\t\\tfont-size: 10px;\\r\\n\\t}\\r\\n\\r\\n\\t.horario-envio-mensagem[_ngcontent-%COMP%] {\\r\\n\\t\\tfont-size: 8px;\\r\\n\\t}\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoYXQtbWVuc2FnZW0uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtDQUNDLGtCQUFrQjtBQUNuQjs7QUFFQTtDQUNDLGFBQWE7Q0FDYixhQUFhO0NBQ2IsbUJBQW1CO0NBQ25CLDRDQUE0QztBQUM3Qzs7QUFFQTtDQUNDLGVBQWU7QUFDaEI7O0FBRUE7Q0FDQyx1QkFBdUI7Q0FDdkIscUNBQXFDO0NBQ3JDLGtCQUFrQjtDQUNsQixXQUFXO0FBQ1o7O0FBRUE7Q0FDQyxnQkFBZ0I7Q0FDaEIscUJBQXFCO0NBQ3JCLFlBQVk7QUFDYjs7QUFFQTtDQUNDLGFBQWE7QUFDZDs7QUFFQTtDQUNDLGVBQWU7QUFDaEI7O0FBRUE7Q0FDQyxXQUFXO0NBQ1gsWUFBWTtDQUNaLG1CQUFtQjtBQUNwQjs7QUFFQTtDQUNDLGFBQWE7Q0FDYixrQ0FBa0M7QUFDbkM7O0FBR0E7Q0FDQyxrQkFBa0I7Q0FDbEIsY0FBYztDQUNkLFlBQVk7QUFDYjs7QUFFQTtDQUNDLFlBQVk7Q0FDWixtQkFBbUI7QUFDcEI7O0FBRUE7Q0FDQyxtQkFBbUI7Q0FDbkIseUJBQXlCO0NBQ3pCLGNBQWM7QUFDZjs7QUFFQTtDQUNDLGdCQUFnQjtBQUNqQjs7QUFFQTtDQUNDLGNBQWM7Q0FDZCxjQUFjO0FBQ2Y7O0FBRUE7Q0FDQyxnQkFBZ0I7Q0FDaEIsc0NBQXNDO0FBQ3ZDOztBQUVBO0NBQ0MsYUFBYTtBQUNkOztBQUVBO0NBQ0MsaUJBQWlCO0NBQ2pCLG9CQUFvQjtDQUNwQixpQkFBaUI7Q0FDakIsbUJBQW1CO0FBQ3BCOztBQUVBO0NBQ0MsZUFBZTtBQUNoQjs7QUFFQTtDQUNDLGVBQWU7QUFDaEI7O0FBRUE7Q0FDQztFQUNDLGtCQUFrQjtDQUNuQjtBQUNEOztBQUVBO0NBQ0M7RUFDQyxVQUFVO0NBQ1g7O0NBRUE7RUFDQyxjQUFjO0VBQ2QsMkJBQTJCO0VBQzNCLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsNEJBQTRCO0NBQzdCOztDQUVBO0VBQ0MsdUJBQXVCO0VBQ3ZCLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsV0FBVztDQUNaOztDQUVBO0VBQ0MsZUFBZTtDQUNoQjs7Q0FFQTtFQUNDLGVBQWU7Q0FDaEI7O0NBRUE7RUFDQyxjQUFjO0NBQ2Y7O0NBRUE7RUFDQyxrQkFBa0I7RUFDbEIsdUJBQXVCO0VBQ3ZCLFNBQVM7RUFDVCxRQUFRO0VBQ1IsT0FBTztDQUNSO0FBQ0Q7O0FBRUE7Q0FDQztFQUNDLGVBQWU7RUFDZixrQkFBa0I7RUFDbEIsNENBQTRDO0NBQzdDOztDQUVBO0VBQ0MsZUFBZTtDQUNoQjs7Q0FFQTtFQUNDLGVBQWU7Q0FDaEI7O0NBRUE7RUFDQyxlQUFlO0NBQ2hCOztDQUVBO0VBQ0MsY0FBYztDQUNmO0FBQ0QiLCJmaWxlIjoiY2hhdC1tZW5zYWdlbS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNhcmQtY2hhdCB7XHJcblx0cGFkZGluZzogMzBweCAzMHZ3O1xyXG59XHJcblxyXG4uY2FyZC10b3BvIHtcclxuXHRwYWRkaW5nOiAxMHB4O1xyXG5cdGRpc3BsYXk6IGZsZXg7XHJcblx0YWxpZ24taXRlbXM6IGNlbnRlcjtcclxuXHRib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tY29yLWRlLWZ1bmRvKTtcclxufVxyXG5cclxuLmNhcmQtdG9wbz5oMyB7XHJcblx0Zm9udC1zaXplOiAyNXB4O1xyXG59XHJcblxyXG4uY2hhdC1jb20tdXN1YXJpb3Mge1xyXG5cdGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xyXG5cdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWNvci1kZS1mdW5kbyk7XHJcblx0Ym9yZGVyLXJhZGl1czogNXB4O1xyXG5cdHdpZHRoOiAxMDAlO1xyXG59XHJcblxyXG4uaW5mby11c3VhcmlvLWNoYXQge1xyXG5cdGNvbHVtbi1nYXA6IDEwcHg7XHJcblx0cGFkZGluZzogMCA1cHggMCAyMHB4O1xyXG5cdGZsZXgtZ3JvdzogMTtcclxufVxyXG5cclxuLmVzcGFjby1tc2cge1xyXG5cdHBhZGRpbmc6IDEwcHg7XHJcbn1cclxuXHJcbi5lc3BhY28tbXNnLWZvdG8ge1xyXG5cdGNvbHVtbi1nYXA6IDVweDtcclxufVxyXG5cclxuLmltZy1wZXJmaWwge1xyXG5cdHdpZHRoOiA0NXB4O1xyXG5cdGhlaWdodDogNDVweDtcclxuXHRib3JkZXItcmFkaXVzOiAzNXB4O1xyXG59XHJcblxyXG4uaGVhZGVyLW1vZGFsLWFsaWduIHtcclxuXHRkaXNwbGF5OiBncmlkO1xyXG5cdGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDFmciAxZnI7XHJcbn1cclxuXHJcblxyXG4uY2hhdHMge1xyXG5cdHBhZGRpbmc6IDEwcHggMTVweDtcclxuXHRvdmVyZmxvdzogYXV0bztcclxuXHRoZWlnaHQ6IDUwdmg7XHJcbn1cclxuXHJcbi5jYXJkIHtcclxuXHRib3JkZXI6IG5vbmU7XHJcblx0Ym9yZGVyLXJhZGl1czogMTVweDtcclxufVxyXG5cclxuLmZvcm0tY29udHJvbCB7XHJcblx0Ym9yZGVyLXJhZGl1czogMTJweDtcclxuXHRib3JkZXI6IDFweCBzb2xpZCAjRjBGMEYwO1xyXG5cdGZvbnQtc2l6ZTogOHB4O1xyXG59XHJcblxyXG4uZm9ybS1jb250cm9sOmZvY3VzIHtcclxuXHRib3gtc2hhZG93OiBub25lO1xyXG59XHJcblxyXG4uZm9ybS1jb250cm9sOjpwbGFjZWhvbGRlciB7XHJcblx0Zm9udC1zaXplOiA4cHg7XHJcblx0Y29sb3I6ICNDNEM0QzQ7XHJcbn1cclxuXHJcbi5mb3JtdWxhcmlvLWNvbWVudGFyaW8ge1xyXG5cdG1hcmdpbi10b3A6IDE1cHg7XHJcblx0Ym9yZGVyLXRvcDogMXB4IHNvbGlkIHJnYigwIDAgMCAvIDEzJSk7XHJcbn1cclxuXHJcbi5mb3JtdWxhcmlvLWNvbWVudGFyaW8ge1xyXG5cdGRpc3BsYXk6IGZsZXg7XHJcbn1cclxuXHJcbi5mb3JtLWNvbnRyb2wge1xyXG5cdHBhZGRpbmctdG9wOiAxNXB4O1xyXG5cdHBhZGRpbmctYm90dG9tOiAxNXB4O1xyXG5cdGJvcmRlci1sZWZ0OiBub25lO1xyXG5cdGJvcmRlci1ib3R0b206IG5vbmU7XHJcbn1cclxuXHJcbi50ZXh0by1pbnB1dCB7XHJcblx0Zm9udC1zaXplOiAxNnB4O1xyXG59XHJcblxyXG4udGV4dG8taW5wdXQ6OnBsYWNlaG9sZGVyIHtcclxuXHRmb250LXNpemU6IDE2cHg7XHJcbn1cclxuXHJcbkBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDEwMjRweCkge1xyXG5cdC5jYXJkLWNoYXQge1xyXG5cdFx0cGFkZGluZzogMzBweCAxNXZ3O1xyXG5cdH1cclxufVxyXG5cclxuQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNzY4cHgpIHtcclxuXHQuY2FyZC1jaGF0IHtcclxuXHRcdHBhZGRpbmc6IDA7XHJcblx0fVxyXG5cclxuXHQuY2hhdHMge1xyXG5cdFx0b3ZlcmZsb3c6IGF1dG87XHJcblx0XHRoZWlnaHQ6IGNhbGMoMTAwdmggLSAyMDBweCk7XHJcblx0XHRtYXgtaGVpZ2h0OiBub25lO1xyXG5cdFx0bWluLWhlaWdodDogbm9uZTtcclxuXHRcdHBhZGRpbmc6IDIwcHggMTVweCA1MHB4IDE1cHg7XHJcblx0fVxyXG5cclxuXHQuY2hhdC1jb20tdXN1YXJpb3Mge1xyXG5cdFx0YmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XHJcblx0XHRib3JkZXI6IG5vbmU7XHJcblx0XHRib3JkZXItcmFkaXVzOiAwO1xyXG5cdFx0d2lkdGg6IDEwMCU7XHJcblx0fVxyXG5cclxuXHQuY2hhdC11c2VybmFtZS11c3VhcmlvIHtcclxuXHRcdGZvbnQtc2l6ZTogMTVweDtcclxuXHR9XHJcblxyXG5cdC5jaGF0LXVsdGltYS1tZW5zYWdlbSB7XHJcblx0XHRmb250LXNpemU6IDExcHg7XHJcblx0fVxyXG5cclxuXHQuaG9yYXJpby1lbnZpby1tZW5zYWdlbSB7XHJcblx0XHRmb250LXNpemU6IDlweDtcclxuXHR9XHJcblxyXG5cdC5lbnZpYXItbWVuc2FnZW5zIHtcclxuXHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuXHRcdGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xyXG5cdFx0Ym90dG9tOiAwO1xyXG5cdFx0cmlnaHQ6IDA7XHJcblx0XHRsZWZ0OiAwO1xyXG5cdH1cclxufVxyXG5cclxuQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogMzUwcHgpIHtcclxuXHQuY2FyZC10b3BvIHtcclxuXHRcdHBhZGRpbmc6IDIwcHggMDtcclxuXHRcdHRleHQtYWxpZ246IGNlbnRlcjtcclxuXHRcdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1jb3ItZGUtZnVuZG8pO1xyXG5cdH1cclxuXHJcblx0Lm1lbm9yIHtcclxuXHRcdGZvbnQtc2l6ZTogMTFweDtcclxuXHR9XHJcblxyXG5cdC5jaGF0LXVzZXJuYW1lLXVzdWFyaW8ge1xyXG5cdFx0Zm9udC1zaXplOiAxMXB4O1xyXG5cdH1cclxuXHJcblx0LmNoYXQtdWx0aW1hLW1lbnNhZ2VtIHtcclxuXHRcdGZvbnQtc2l6ZTogMTBweDtcclxuXHR9XHJcblxyXG5cdC5ob3JhcmlvLWVudmlvLW1lbnNhZ2VtIHtcclxuXHRcdGZvbnQtc2l6ZTogOHB4O1xyXG5cdH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["SeguidoresSeguindoUtil","catchError","ElementRef","Validators","urlApi","UsuarioUtil","i0","mensagem_r2","ChatMensagemComponent","constructor","activateRouter","userAuthService","mensagemService","formBuilder","ngOnInit","usuarioAuthenticadoUsername","pegarUsernameUsuarioAutenticado","paramsUrlSubscription","params","subscribe","buscarMensagensDoChat","formGroup","group","mensagem","required","maxLength","mensagemSubscription","escutarMensagensDoServidor","pipe","err","alert","mensagens","push","scrollToBottom","username","outroUsuarioDoChat","mensagensChatSubscription","buscarMensagensComOUsuario","enviarMensagem","get","value","mensagemDto","reset","setTimeout","chatMensagensArea","nativeElement","scrollTop","scrollHeight","errorImage","event","definirImagemDefault","ngOnDestroy","desativarObservable","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\Maria Sônia\\Documents\\Workspace-Node\\rede-social\\src\\app\\home\\chats\\chat-mensagem\\chat-mensagem.component.ts","C:\\Users\\Maria Sônia\\Documents\\Workspace-Node\\rede-social\\src\\app\\home\\chats\\chat-mensagem\\chat-mensagem.component.html"],"sourcesContent":["import { SeguidoresSeguindoUtil } from './../../../../core/util/seguidores-seguindo.util';\nimport { Subscription, catchError } from 'rxjs';\nimport { Component, ElementRef, OnInit, Renderer2, ViewChild, OnDestroy } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Params } from '@angular/router';\nimport { MensagemDto } from 'src/core/dto/mensagem.dto';\nimport { MensagemService } from 'src/core/service/mensagem.service';\nimport { UserAuthenticateService } from 'src/core/service/user-authenticate.service';\nimport { urlApi } from 'src/core/util/url-api';\nimport { UsuarioUtil } from 'src/core/util/usuario.util';\n\n@Component({\n\ttemplateUrl: './chat-mensagem.component.html',\n\tstyleUrls: ['./chat-mensagem.component.css']\n})\nexport class ChatMensagemComponent implements OnInit, OnDestroy {\n\tpublic usuarioAuthenticadoUsername: string;\n\tpublic urlApi: string = urlApi;\n\tpublic mensagens: Array<MensagemDto>;\n\tpublic formGroup: FormGroup;\n\tpublic outroUsuarioDoChat: string;\n\n\tprivate mensagensChatSubscription: Subscription;\n\tprivate mensagemSubscription: Subscription;\n\tprivate paramsUrlSubscription: Subscription;\n\n\t@ViewChild('chatArea')\n\tpublic chatMensagensArea: ElementRef<HTMLDivElement>;\n\n\tconstructor(private activateRouter: ActivatedRoute,\n\t\tprivate userAuthService: UserAuthenticateService,\n\t\tprivate mensagemService: MensagemService,\n\t\tprivate formBuilder: FormBuilder) { }\n\n\tngOnInit(): void {\n\t\tthis.usuarioAuthenticadoUsername = this.userAuthService.pegarUsernameUsuarioAutenticado();\n\t\tthis.paramsUrlSubscription = this.activateRouter.params\n\t\t\t.subscribe((params => this.buscarMensagensDoChat(params)));\n\t\tthis.formGroup = this.formBuilder.group({\n\t\t\tmensagem: ['', [Validators.required, Validators.maxLength(1000)]]\n\t\t});\n\t\tthis.mensagemSubscription = this.mensagemService.escutarMensagensDoServidor()\n\t\t\t.pipe(catchError(async (err) => alert(err)))\n\t\t\t.subscribe(mensagem => this.mensagens.push(mensagem) && this.scrollToBottom(),\n\t\t\t\t(err: any) => alert('erro'), () => alert('Porra'));\n\t}\n\n\tbuscarMensagensDoChat(params: Params): void {\n\t\tconst username = params['username'];\n\t\tthis.outroUsuarioDoChat = username;\n\t\tthis.mensagensChatSubscription = this.mensagemService.buscarMensagensComOUsuario(username)\n\t\t\t.subscribe(mensagens => {\n\t\t\t\tthis.mensagens = mensagens;\n\t\t\t\tthis.scrollToBottom();\n\t\t\t});\n\t}\n\n\tenviarMensagem(): void {\n\t\tconst mensagem = this.formGroup.get('mensagem')?.value;\n\t\tconst mensagemDto = this.mensagemService.enviarMensagem(mensagem, this.outroUsuarioDoChat);\n\t\tthis.mensagens.push(mensagemDto);\n\t\tthis.mensagens = this.mensagens;\n\t\tthis.formGroup.reset();\n\t\tthis.scrollToBottom();\n\t}\n\n\tscrollToBottom(): void {\n\t\ttry {\n\t\t\tsetTimeout(() => this.chatMensagensArea.nativeElement.scrollTop = this.chatMensagensArea.nativeElement.scrollHeight, 200);\n\t\t} catch (err) { }\n\t}\n\n\terrorImage(event: Event) {\n\t\tUsuarioUtil.definirImagemDefault(event);\n\t}\n\n\tngOnDestroy(): void {\n\t\tSeguidoresSeguindoUtil.desativarObservable(this.mensagensChatSubscription,\n\t\t\tthis.mensagemSubscription,\n\t\t\tthis.paramsUrlSubscription);\n\t}\n}\n","<div class=\"card-chat\">\n\t<div class=\"chat-com-usuarios\">\n\t\t<div class=\"card-topo\">\n\t\t\t<button type=\"button\" class=\"btn-close\" aria-label=\"Close\" [routerLink]=\"['/home', 'chats']\"></button>\n\t\t\t<div class=\"d-flex align-items-center py-1 info-usuario-chat\">\n\t\t\t\t<div class=\"position-relative\">\n\t\t\t\t\t<img (error)=\"errorImage($event)\"\n\t\t\t\t\t\tsrc=\"{{urlApi}}/api/v1/usuarios/{{outroUsuarioDoChat}}}/imagemDoPerfil\"\n\t\t\t\t\t\tclass=\"rounded-circle mr-1\" alt=\"Sharon Lessman\" width=\"40\" height=\"40\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex-grow-1 pl-3 text-start\">\n\t\t\t\t\t<strong>{{outroUsuarioDoChat}}</strong>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<button class=\"btn btn-light border btn-lg px-3\" [routerLink]=\"['/home', outroUsuarioDoChat]\">Ver\n\t\t\t\t\t\tperfil</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"chats\" #chatArea>\n\t\t\t<rs-spinnerloading [elementoAguardado]=\"mensagens\"></rs-spinnerloading>\n\t\t\t<div *ngFor=\"let mensagem of mensagens\">\n\t\t\t\t<rs-mensagens [usuarioAuthenticadoUsername]=\"usuarioAuthenticadoUsername\" [mensagem]=\"mensagem\">\n\t\t\t\t</rs-mensagens>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"flex-grow-0 border-top enviar-mensagens\">\n\t\t\t<form [formGroup]=\"formGroup\" class=\"input-group\" (submit)=\"enviarMensagem()\">\n\t\t\t\t<input formControlName=\"mensagem\" type=\"text\" class=\"form-control texto-input\"\n\t\t\t\t\tplaceholder=\"Digite uma mensagem\">\n\t\t\t\t<button [disabled]=\"formGroup.invalid\" type=\"submit\" class=\"btn btn-primary\">Enviar</button>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</div>"]},"metadata":{},"sourceType":"module"}