{"ast":null,"code":"import { ChatUtil } from './../../../core/util/chat.util';\nimport { urlApi } from 'src/core/util/url-api';\nimport { UsuarioUtil } from 'src/core/util/usuario.util';\nimport { SeguidoresSeguindoUtil } from './../../../core/util/seguidores-seguindo.util';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/core/service/user-authenticate.service\";\nimport * as i3 from \"./../../../core/service/mensagem.service\";\nimport * as i4 from \"./../../../core/service/chat.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../../core/pipe/nome-do-usuario-format.pipe\";\nimport * as i7 from \"../../../core/pipe/formatar-data.pipe\";\n\nfunction ChatsComponent_h3_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h3\", 6);\n    i0.ɵɵtext(1, \"Nenhum chat encontrado\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"destacar-pp\": a0\n  };\n};\n\nfunction ChatsComponent_div_7_div_1_p_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 16)(1, \"span\", 17);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"formatarNomeDoUsuario\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const chat_r2 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(6, _c0, !chat_r2.ultimaMensagem.foiVista));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(8, _c0, !chat_r2.ultimaMensagem.foiVista));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", chat_r2.ultimaMensagem.emissor, \": \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(4, 4, chat_r2.ultimaMensagem.mensagem), \" \");\n  }\n}\n\nfunction ChatsComponent_div_7_div_1_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 18)(1, \"span\", 19);\n    i0.ɵɵtext(2, \"Voc\\u00EA: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"formatarNomeDoUsuario\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const chat_r2 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(4, 1, chat_r2.ultimaMensagem.mensagem), \" \");\n  }\n}\n\nconst _c1 = function (a0) {\n  return {\n    \"destacar-pp chat-username-usuario-menor\": a0\n  };\n};\n\nfunction ChatsComponent_div_7_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"img\", 11);\n    i0.ɵɵlistener(\"error\", function ChatsComponent_div_7_div_1_Template_img_error_1_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.errorImage($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"div\", 12)(3, \"p\", 13);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\");\n    i0.ɵɵtemplate(6, ChatsComponent_div_7_div_1_p_6_Template, 5, 10, \"p\", 14);\n    i0.ɵɵtemplate(7, ChatsComponent_div_7_div_1_p_7_Template, 5, 3, \"p\", 15);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const chat_r2 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate2(\"src\", \"\", ctx_r3.urlApi, \"/api/v1/usuarios/\", chat_r2.quemOUsuarioAutenticadoEstaConversando, \"/imagemDoPerfil\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(6, _c1, !chat_r2.ultimaMensagem.foiVista));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", chat_r2.quemOUsuarioAutenticadoEstaConversando, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", chat_r2.ultimaMensagem && chat_r2.ultimaMensagem.emissor !== ctx_r3.usuarioAuthenticadoUsername);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", chat_r2.ultimaMensagem && chat_r2.ultimaMensagem.emissor === ctx_r3.usuarioAuthenticadoUsername);\n  }\n}\n\nconst _c2 = function (a0) {\n  return {\n    \"ocutar\": a0\n  };\n};\n\nfunction ChatsComponent_div_7_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"p\", 21);\n    i0.ɵɵtext(2, \"\\u2022\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\", 22);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"formatarData\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const chat_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(5, _c2, chat_r2.ultimaMensagem.foiVista));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(7, _c0, !chat_r2.ultimaMensagem.foiVista));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 3, chat_r2.ultimaMensagem.dataSemFormatar));\n  }\n}\n\nconst _c3 = function (a2) {\n  return [\"/home\", \"chats\", a2];\n};\n\nfunction ChatsComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtemplate(1, ChatsComponent_div_7_div_1_Template, 8, 8, \"div\", 8);\n    i0.ɵɵtemplate(2, ChatsComponent_div_7_div_2_Template, 6, 9, \"div\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const chat_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(3, _c3, chat_r2.quemOUsuarioAutenticadoEstaConversando));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", chat_r2.ultimaMensagem);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", chat_r2.ultimaMensagem);\n  }\n}\n\nexport let ChatsComponent = /*#__PURE__*/(() => {\n  class ChatsComponent {\n    constructor(activatedRoute, userAuthService, mensagemService, chatService) {\n      this.activatedRoute = activatedRoute;\n      this.userAuthService = userAuthService;\n      this.mensagemService = mensagemService;\n      this.chatService = chatService;\n      this.chats = new Array();\n      this.urlApi = urlApi;\n    }\n\n    ngOnInit() {\n      this.usuarioAuthenticadoUsername = this.userAuthService.pegarUsernameUsuarioAutenticado();\n      this.chatSubscription = this.activatedRoute.data.subscribe(data => this.chats = data['chats']);\n      this.mensagemSubscription = this.mensagemService.escutarMensagensDoServidor().subscribe(mensagem => this.adicionarMensagemAoChat(mensagem));\n    }\n\n    adicionarMensagemAoChat(mensagem) {\n      const chatDaMensagemRecebidaIndex = this.chats.findIndex(chat => chat.id === mensagem.chatId);\n\n      if (chatDaMensagemRecebidaIndex !== -1) {\n        const chatMensagemRecebida = this.chats[chatDaMensagemRecebidaIndex];\n        chatMensagemRecebida.ultimaMensagem = mensagem;\n        this.chats[chatDaMensagemRecebidaIndex] = chatMensagemRecebida;\n        mensagem.foiVista = false;\n        this.ordenarChatsPorMensagensMaisRecentes();\n        return;\n      }\n\n      this.chatService.buscarChatDoUsuarioAutenticadoPeloId(mensagem.chatId).subscribe(chat => {\n        ChatUtil.definirComQuemOUsuarioEstaConversando(chat, this.usuarioAuthenticadoUsername);\n        chat.ultimaMensagem.foiVista = false;\n        this.chats.push(chat);\n        this.ordenarChatsPorMensagensMaisRecentes();\n      });\n    }\n\n    ordenarChatsPorMensagensMaisRecentes() {\n      this.chats.sort((chat1, chat2) => chat2.ultimaMensagem.dataSemFormatar > chat1.ultimaMensagem.dataSemFormatar ? 1 : -1);\n    }\n\n    errorImage(event) {\n      UsuarioUtil.definirImagemDefault(event);\n    }\n\n    ngOnDestroy() {\n      SeguidoresSeguindoUtil.desativarObservable(this.chatSubscription, this.mensagemSubscription);\n    }\n\n  }\n\n  ChatsComponent.ɵfac = function ChatsComponent_Factory(t) {\n    return new (t || ChatsComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.UserAuthenticateService), i0.ɵɵdirectiveInject(i3.MensagemService), i0.ɵɵdirectiveInject(i4.ChatService));\n  };\n\n  ChatsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ChatsComponent,\n    selectors: [[\"ng-component\"]],\n    decls: 8,\n    vars: 2,\n    consts: [[1, \"card-chat\"], [1, \"chat-com-usuarios\"], [1, \"card-topo\"], [1, \"chats\"], [\"class\", \"nao-encontrado-mensagem\", 4, \"ngIf\"], [\"class\", \"chat-mensagens\", 3, \"routerLink\", 4, \"ngFor\", \"ngForOf\"], [1, \"nao-encontrado-mensagem\"], [1, \"chat-mensagens\", 3, \"routerLink\"], [\"class\", \"chat-info\", 4, \"ngIf\"], [\"class\", \"info-msg\", 4, \"ngIf\"], [1, \"chat-info\"], [1, \"img-perfil\", \"clicavel\", 3, \"src\", \"error\"], [1, \"info-mensagem\"], [1, \"chat-username-usuario\", 3, \"ngClass\"], [\"class\", \"chat-ultima-mensagem\", 3, \"ngClass\", 4, \"ngIf\"], [\"class\", \"chat-ultima-mensagem\", 4, \"ngIf\"], [1, \"chat-ultima-mensagem\", 3, \"ngClass\"], [1, \"destacar\", 3, \"ngClass\"], [1, \"chat-ultima-mensagem\"], [1, \"destacar\"], [1, \"info-msg\"], [1, \"pontinho-msg-nao-vista\", 3, \"ngClass\"], [1, \"horario-envio-mensagem\", 3, \"ngClass\"]],\n    template: function ChatsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h3\");\n        i0.ɵɵtext(4, \"Chats abertos\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"div\", 3);\n        i0.ɵɵtemplate(6, ChatsComponent_h3_6_Template, 2, 0, \"h3\", 4);\n        i0.ɵɵtemplate(7, ChatsComponent_div_7_Template, 3, 5, \"div\", 5);\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", !ctx.chats.length);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.chats);\n      }\n    },\n    dependencies: [i5.NgClass, i5.NgForOf, i5.NgIf, i1.RouterLink, i6.NomeDoUsuarioFormatPipe, i7.FormatarDataPipe],\n    styles: [\".card-chat[_ngcontent-%COMP%]{padding:30px 30vw}.card-topo[_ngcontent-%COMP%]{padding:20px 0;text-align:center;border-bottom:1px solid var(--cor-de-fundo)}.card-topo[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{font-size:25px}.chat-com-usuarios[_ngcontent-%COMP%]{background-color:#fff;border:1px solid var(--cor-de-fundo);border-radius:5px;width:100%}.header-modal-align[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr}.chats[_ngcontent-%COMP%]{overflow:auto;min-height:80px;max-height:60vh}.centralizado[_ngcontent-%COMP%]{grid-column:2;justify-self:center}.nao-encontrado-mensagem[_ngcontent-%COMP%]{text-align:center;margin-top:20px}.chat-username-usuario[_ngcontent-%COMP%]{display:flex;font-size:18px;justify-content:space-between;padding-right:10px}.chat-username-usuario-menor[_ngcontent-%COMP%]{font-size:16px}.chat-mensagens[_ngcontent-%COMP%]{padding:10px;display:flex;justify-content:space-between;column-gap:5px}.chat-mensagens[_ngcontent-%COMP%]:hover{background-color:#f0f8ff;cursor:pointer}.chat-info[_ngcontent-%COMP%]{display:flex;column-gap:15px;align-items:center}.chat-ultima-mensagem[_ngcontent-%COMP%]{font-size:14px}.destacar[_ngcontent-%COMP%]{font-weight:500}.img-perfil[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:45px}.info-mensagem[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:7px}.menor[_ngcontent-%COMP%]{font-size:14px}.mostrar-mais[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}.info-msg[_ngcontent-%COMP%]{display:flex;flex-direction:column}.pontinho-msg-nao-vista[_ngcontent-%COMP%]{color:#0095f6;justify-self:center;align-self:flex-end;font-size:40px}.destacar-pp[_ngcontent-%COMP%]{font-weight:600}.ocutar[_ngcontent-%COMP%]{visibility:hidden}.horario-envio-mensagem[_ngcontent-%COMP%]{font-size:10px;justify-self:flex-end;margin-bottom:10px;text-align:center}@media screen and (max-width: 1024px){.card-chat[_ngcontent-%COMP%]{padding:30px 15vw}}@media screen and (max-width: 557px){.card-chat[_ngcontent-%COMP%]{padding:0}.chats[_ngcontent-%COMP%]{overflow:auto;height:calc(100vh - 130px);max-height:none;min-height:none}.chat-com-usuarios[_ngcontent-%COMP%]{background-color:#fff;border:none;border-radius:0;width:100%}.chat-username-usuario[_ngcontent-%COMP%]{font-size:15px}.chat-ultima-mensagem[_ngcontent-%COMP%]{font-size:11px}.horario-envio-mensagem[_ngcontent-%COMP%]{font-size:9px}}@media screen and (max-width: 350px){.card-topo[_ngcontent-%COMP%]{padding:20px 0;text-align:center;border-bottom:1px solid var(--cor-de-fundo)}.menor[_ngcontent-%COMP%], .chat-username-usuario[_ngcontent-%COMP%]{font-size:11px}.chat-ultima-mensagem[_ngcontent-%COMP%]{font-size:10px}.horario-envio-mensagem[_ngcontent-%COMP%]{font-size:8px}}\"]\n  });\n  return ChatsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}